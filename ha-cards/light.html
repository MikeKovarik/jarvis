<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<style>
			body {
				background-color: #111;
				font-family: Roboto;
				font-size: 16px;
				color: #FFF;
				padding-bottom: 1000px;
			}
			light2-card {
				width: 300px;
				height: 120px;
				margin: 0.5rem;
			}
		</style>
	</head>
	<body>

		<script type="importmap">
		{
			"imports": {
				"lit": "/node_modules/lit/index.js",
				"lit/": "/node_modules/lit/",
				"lit-element": "/node_modules/lit-element/index.js",
				"lit-element/": "/node_modules/lit-element/",
				"lit-html": "/node_modules/lit-html/lit-html.js",
				"lit-html/": "/node_modules/lit-html/",
				"@lit/": "/node_modules/@lit/",
				"@lit/reactive-element/": "/node_modules/@lit/reactive-element/",
				"@lit/reactive-element": "/node_modules/@lit/reactive-element/reactive-element.js"
			}
		}
		</script>

		<script src="./lit.umd.js"></script>
		<script src="./ha-card.js"></script>
		<script src="./dist/my-awesome-cards.js"></script>
		<script type="module">
			import {html, render} from 'lit'

			const baseConfig = {"type":"custom:light2-card"}

			const demoStates = [
				{"light":{"entity_id":"light.bulb_couch","state":"off","attributes":{"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["brightness"],"linkquality":81,"update":{"state":"available"},"update_available":null,"friendly_name":"bulb-couch","supported_features":45},"last_changed":"2022-03-26T23:25:31.459077+00:00","last_updated":"2022-03-27T13:55:05.838614+00:00","context":{"id":"51d270fde31e539d5f4252018e4ae66c","parent_id":null,"user_id":null}},"update_available":{"entity_id":"binary_sensor.bulb_couch_update_available","state":"on","attributes":{"brightness":64,"linkquality":81,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"bulb-couch update available"},"last_changed":"2022-03-26T17:49:37.388495+00:00","last_updated":"2022-03-27T13:55:05.837611+00:00","context":{"id":"0d52b290be1467318de584f6bc8ac8b2","parent_id":null,"user_id":null}}},
				/*
				{"light":{"entity_id":"light.bulb_couch","state":"off","attributes":{"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["brightness"],"color_mode":"brightness","brightness":136,"linkquality":96,"update":{"state":"available"},"update_available":null,"friendly_name":"bulb-couch","supported_features":45},"last_changed":"2022-03-27T14:01:27.485387+00:00","last_updated":"2022-03-27T14:01:28.472152+00:00","context":{"id":"650c85d8cb9fddfce41d66f7ad5cbe18","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}},"update_available":{"entity_id":"binary_sensor.bulb_couch_update_available","state":"on","attributes":{"brightness":136,"linkquality":96,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"bulb-couch update available"},"last_changed":"2022-03-26T17:49:37.388495+00:00","last_updated":"2022-03-27T14:01:28.471213+00:00","context":{"id":"ae9bffa778da3c0feeabecaef64b6310","parent_id":null,"user_id":null}}},
				{"light":{"entity_id":"light.bulb_couch","state":"on","attributes":{"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["brightness"],"color_mode":"brightness","brightness":136,"linkquality":96,"update":{"state":"available"},"update_available":null,"friendly_name":"bulb-couch","supported_features":45},"last_changed":"2022-03-27T14:01:27.485387+00:00","last_updated":"2022-03-27T14:01:28.472152+00:00","context":{"id":"650c85d8cb9fddfce41d66f7ad5cbe18","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}},"update_available":{"entity_id":"binary_sensor.bulb_couch_update_available","state":"on","attributes":{"brightness":136,"linkquality":96,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"bulb-couch update available"},"last_changed":"2022-03-26T17:49:37.388495+00:00","last_updated":"2022-03-27T14:01:28.471213+00:00","context":{"id":"ae9bffa778da3c0feeabecaef64b6310","parent_id":null,"user_id":null}}},
				{"light":{"entity_id":"light.bulb_couch","state":"on","attributes":{"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["brightness"],"color_mode":"brightness","brightness":255,"linkquality":102,"update":{"state":"available"},"update_available":null,"friendly_name":"bulb-couch","supported_features":45},"last_changed":"2022-03-27T14:01:27.485387+00:00","last_updated":"2022-03-27T14:01:55.160010+00:00","context":{"id":"3cb6f5165d201ff488b48bf953463f80","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}},"update_available":{"entity_id":"binary_sensor.bulb_couch_update_available","state":"on","attributes":{"brightness":254,"linkquality":102,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"bulb-couch update available"},"last_changed":"2022-03-26T17:49:37.388495+00:00","last_updated":"2022-03-27T14:01:55.158035+00:00","context":{"id":"556293fad677225d8a87097aa076e133","parent_id":null,"user_id":null}}},
				{"switch":{"entity_id":"switch.lamp_reading","state":"off","attributes":{"color_mode":"xy","linkquality":126,"update":{"state":"available"},"update_available":null,"friendly_name":"lamp-reading"},"last_changed":"2022-03-26T17:50:58.712663+00:00","last_updated":"2022-03-27T13:50:59.330792+00:00","context":{"id":"627b372e4dc5339f591e436832c5a6cb","parent_id":null,"user_id":null}},"update_available":{"entity_id":"binary_sensor.lamp_reading_update_available","state":"on","attributes":{"color_mode":"xy","linkquality":126,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"lamp-reading update available"},"last_changed":"2022-03-26T17:49:37.275738+00:00","last_updated":"2022-03-27T13:50:59.329956+00:00","context":{"id":"41c587b7645c6d0607d329296cadb837","parent_id":null,"user_id":null}}},
				{"switch":{"entity_id":"switch.plug_heatpad","state":"on","attributes":{"device_temperature":32,"energy":6.43,"linkquality":153,"power":0,"update":{"state":"idle"},"update_available":null,"friendly_name":"plug-heatpad"},"last_changed":"2022-03-26T23:06:43.053944+00:00","last_updated":"2022-03-27T14:03:10.103185+00:00","context":{"id":"92bb1fc6f2ad04bf07619b6a342b739d","parent_id":null,"user_id":null}},"power":{"entity_id":"sensor.plug_heatpad_power","state":"0","attributes":{"state_class":"measurement","device_temperature":32,"energy":6.43,"linkquality":153,"power":0,"update":{"state":"idle"},"update_available":null,"unit_of_measurement":"W","device_class":"power","friendly_name":"plug-heatpad power"},"last_changed":"2022-03-27T14:01:36.623165+00:00","last_updated":"2022-03-27T14:03:10.100840+00:00","context":{"id":"51010352d6107d89a16a937c44895be8","parent_id":null,"user_id":null}},"energy":{"entity_id":"sensor.plug_heatpad_energy","state":"6.43","attributes":{"state_class":"total_increasing","device_temperature":32,"energy":6.43,"linkquality":153,"power":0,"update":{"state":"idle"},"update_available":null,"unit_of_measurement":"kWh","device_class":"energy","friendly_name":"plug-heatpad energy"},"last_changed":"2022-03-27T13:15:57.476658+00:00","last_updated":"2022-03-27T14:03:10.101504+00:00","context":{"id":"1729194ef96e363d98d3c2dffb0a490e","parent_id":null,"user_id":null}},"device_temperature":{"entity_id":"sensor.plug_heatpad_device_temperature","state":"32","attributes":{"state_class":"measurement","device_temperature":32,"energy":6.43,"linkquality":153,"power":0,"update":{"state":"idle"},"update_available":null,"unit_of_measurement":"Â°C","device_class":"temperature","friendly_name":"plug-heatpad device temperature"},"last_changed":"2022-03-27T13:17:46.166709+00:00","last_updated":"2022-03-27T14:03:10.102062+00:00","context":{"id":"443f734574a91738176c74d45ee78ff3","parent_id":null,"user_id":null}},"update_available":{"entity_id":"binary_sensor.plug_heatpad_update_available","state":"off","attributes":{"device_temperature":32,"energy":6.43,"linkquality":153,"power":0,"update":{"state":"idle"},"update_available":null,"device_class":"update","friendly_name":"plug-heatpad update available"},"last_changed":"2022-03-26T17:49:06.004490+00:00","last_updated":"2022-03-27T14:03:10.102627+00:00","context":{"id":"7d929aae365d5b23ac95d1b21406d515","parent_id":null,"user_id":null}}},
				*/

				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":117,"hs_color":[345.205,28.627],"rgb_color":[255,182,200],"xy_color":[0.403,0.303],"color":{"x":0.403,"y":0.303},"linkquality":105,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T22:03:57.950033+00:00","context":{"id":"3d5073a1f64cac5ed02e8be89e67badb","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				/*
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":90,"hs_color":[354.353,100],"rgb_color":[255,0,24],"xy_color":[0.696,0.297],"color":{"x":0.696,"y":0.297},"linkquality":99,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T22:10:25.765998+00:00","context":{"id":"8630217d52e0d8830af8ab77fb8fb383","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":89,"hs_color":[195.616,28.627],"rgb_color":[182,236,255],"xy_color":[0.252,0.31],"color":{"x":0.252,"y":0.31},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T22:08:40.046624+00:00","context":{"id":"612f3aad467fbe3586c94c8992aac03f","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,100],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,80],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,60],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,40],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,20],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				{"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":10,"hs_color":[211.102,0],"rgb_color":[10,128,255],"xy_color":[0.141,0.134],"color":{"x":0.141,"y":0.134},"linkquality":102,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-06T18:01:55.971003+00:00","last_updated":"2022-04-06T19:05:32.382366+00:00","context":{"id":"1963df4a283eab364dbda17aad530d04","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}},
				*/
				['Custom default color ON', {color: 'ff00FF'}, {"light":{"entity_id":"light.bulb_growlight","state":"on","attributes":{"min_mireds":150,"max_mireds":500,"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["color_temp","xy"],"color_mode":"xy","brightness":163,"hs_color":[299.754,95.686],"rgb_color":[254,11,255],"xy_color":[0.385,0.155],"color":{"x":0.385,"y":0.155},"linkquality":126,"friendly_name":"bulb-growlight","supported_features":63},"last_changed":"2022-04-10T08:26:20.269137+00:00","last_updated":"2022-04-10T08:26:25.519013+00:00","context":{"id":"163a1419189301937acb3c7724838e0b","parent_id":null,"user_id":"bf4261b893ef4dcebafd918baa751736"}}}],
				['Custom default color OFF (should reflect on drag state while off)', {color: 'ff00FF'}, {"light":{"entity_id":"light.bulb_growlight","state":"off","attributes":{"effect_list":["blink","breathe","okay","channel_change","finish_effect","stop_effect"],"supported_color_modes":["brightness"],"linkquality":81,"update":{"state":"available"},"update_available":null,"friendly_name":"bulb-growlight","supported_features":45},"last_changed":"2022-03-26T23:25:31.459077+00:00","last_updated":"2022-03-27T13:55:05.838614+00:00","context":{"id":"51d270fde31e539d5f4252018e4ae66c","parent_id":null,"user_id":null}},"update_available":{"entity_id":"binary_sensor.bulb_couch_update_available","state":"on","attributes":{"brightness":64,"linkquality":81,"update":{"state":"available"},"update_available":null,"device_class":"update","friendly_name":"bulb-couch update available"},"last_changed":"2022-03-26T17:49:37.388495+00:00","last_updated":"2022-03-27T13:55:05.837611+00:00","context":{"id":"0d52b290be1467318de584f6bc8ac8b2","parent_id":null,"user_id":null}}}],
			]

			const cards = new Array(demoStates.length).fill(0).map(a => html`<light2-card></light2-card>`)
			render(cards, document.body)

			const cardNodes = Array.from(document.querySelectorAll('light2-card'))

			const getEntity = state => state.light ?? state.switch

			const unwrapDemo = arg => {
				if (Array.isArray(arg)) {
					let title
					if (typeof arg[0] === 'string') title = arg.shift()
					let [state, config] = [...arg].reverse()
					return {title, config, state}
				} else {
					return {config: {}, state: arg}
				}
			}
			
			demoStates.forEach((demo, i) => {
				const {title, config, state} = unwrapDemo(demo)
				const card = cardNodes[i]
				const entity = getEntity(state).entity_id
				card.setConfig({entity, ...baseConfig, ...config})
				card.state = JSON.parse(JSON.stringify(state))
				card.onStateUpdate()
				setTimeout(() => {
					card.requestUpdate()
					if (title) card.before(title)
				})
			})

		</script>
	</body>
</html>
